# 位置上报

向 Home Assistant 服务器上报地理位置。

## ✨ 亮点

### 🎯 多维辅助定位

> 在传统定位的基础上，针对进入、离开区域时可能遇到的边界情况进行额外的辅助定位和判断。

### 🔋 极致省电策略

> 通过动态调度和网络管理，在保证定位准确的前提下，最大限度地降低电量消耗。

* 荣耀手机实测 7 * 24 小时，每日仅消耗 20-70 mAh 左右电量。

### 🌐 自定义网络偏好

#### 场景1：数据泄露风险

* Home Assistant 服务器默认使用 HTTP 协议。

* 连接公共 Wi‑Fi / 代理网络时，明文数据可能被劫持。

解决方案：选择“禁止代理”并通过“移动数据”上报数据，避开不可信网络。

#### 场景2：网络切换问题

* 刚刚回到家，手机正忙于切换网络，上报可能因此中断。

解决方案：通过“移动数据”上报数据，避开网络切换阶段。

### 👥 多用户支持

> 支持同时向多台 Home Assistant 服务器上报位置。

## 🚀 功能

📍 **基础定位。** 核心功能，每 1 - 15 分钟主动触发上报，支持提供地理坐标、所在区域、海拔、方向、速度等信息。

🧭 **地理围栏。** 通过被动监听手机的 Wi‑Fi 扫描结果，辅助判定进入/离开事件，提升准确性并降低延迟。

🚶 **步数推送。** 支持将本机步数信息同步到 Health Connect（需要系统内置“健康数据共享”组件）。

⚙️ **移除高耗电通知。** 自动移除位置上报和 Home Assistant 应用的高耗电通知，旨在减少打扰（仅荣耀 MagicOS 生效）。

## 🛠️ 构建

### 高德 API Key

* 高德定位可作为融合定位的服务提供商。根据平台要求，需申请并配置高德 API Key 方可使用。

* 这个配置是可选的，如不填写参数，应用内将提供配置入口，配置后亦可正常使用高德定位服务。

<details>
<summary>教程</summary>
<ol>
  <li>在项目根目录查找并打开 <code>local.properties</code>。若文件不存在，请手动创建。</li>
  <li>插入 <code>AMAP_API_KEY=XXX</code> 即可，添加后应用内配置入口将不再显示。</li>
</ol>
</details>
